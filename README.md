# Excel 工具集 - 通用版

## 🎯 專案簡介

這是一個功能強大的 Excel 資料處理工具集，原本針對特定公司設計，現在已經升級為通用版本，可以處理各種格式的報表檔案。

## ✨ 主要功能

### 1. 🚀 通用報表處理器（推薦）
- **智慧偵測**：自動分析報表格式，找出最佳的表頭位置
- **多格式支援**：支援 Excel (.xlsx, .xls)、CSV、文字檔
- **自動編碼偵測**：智慧識別檔案編碼，支援中文
- **欄位類型分析**：自動推斷欄位類型（文字、數字、日期等）
- **預設設定**：提供常見報表格式的預設設定

### 2. 🏢 特定公司 Excel 處理
- 針對特定公司報表格式優化
- 預設跳過行數和欄位選擇
- 快速處理已知格式的報表

### 3. 🔍 Excel VLOOKUP 比對
- 精確比對和模糊比對
- 支援文字清理和標準化
- 產生比對結果和未匹配清單

## 🚀 如何讓工具更通用

### 方法 1：使用通用報表處理器
1. 選擇「🚀 通用報表處理器」分頁
2. 選擇要處理的報表檔案
3. 點擊「開始智慧偵測」
4. 系統會自動分析並建議最佳設定
5. 確認設定後開始處理

### 方法 2：自定義設定檔案
編輯 `config_template.json` 檔案，添加您自己的報表格式：

```json
{
  "自定義設定": {
    "我的公司報表": {
      "skiprows": 3,
      "columns": "1,2,4,5",
      "encoding": "UTF-8",
      "description": "我們公司的標準報表格式",
      "注意事項": "跳過前3行標題，只讀取重要欄位"
    }
  }
}
```

### 方法 3：修改預設設定
在 `config_template.json` 的「預設設定」區段添加新的模板：

```json
{
  "預設設定": {
    "標準報表": {
      "skiprows": 1,
      "columns": "all",
      "encoding": "auto",
      "description": "適用於標準的 Excel 報表"
    }
  }
}
```

## 📁 檔案結構

```
專案根目錄/
├── main.py                    # 主程式
├── universal_processor.py     # 通用報表處理器
├── excel_processor.py         # 特定公司 Excel 處理器
├── excel_matcher.py           # Excel 比對工具
├── config_template.json       # 設定檔案模板
├── README.md                  # 使用說明
└── requirements.txt           # 依賴套件清單
```

## 🛠️ 安裝和執行

### 1. 安裝依賴套件
```bash
pip install pandas PyQt5 chardet rapidfuzz openpyxl
```

### 2. 執行程式
```bash
python main.py
```

## 💡 使用技巧

### 智慧偵測的最佳實踐
1. **檔案準備**：確保報表有清楚的表頭行
2. **格式一致**：同類型的報表使用相同的格式
3. **欄位命名**：使用清楚的欄位名稱（如「商品名稱」、「數量」等）

### 自定義設定的建議
1. **測試設定**：先用小檔案測試設定是否正確
2. **記錄格式**：記錄每種報表格式的設定參數
3. **定期更新**：根據新的報表格式更新設定檔案

## 🔧 進階功能

### 支援的檔案格式
- **Excel**: .xlsx, .xls
- **CSV**: .csv (自動偵測分隔符號)
- **文字檔**: .txt

### 支援的編碼
- UTF-8, UTF-16
- Big5 (繁體中文)
- GBK (簡體中文)
- 自動偵測

### 欄位類型自動識別
- 文字 (Text)
- 數值 (Numeric)
- 日期 (Date)
- 布林值 (Boolean)

## 🚨 注意事項

1. **備份原始檔案**：處理前請備份重要檔案
2. **測試設定**：建議先用測試檔案驗證設定
3. **編碼問題**：如果中文顯示異常，嘗試手動選擇編碼
4. **大檔案處理**：超大檔案可能需要較長處理時間

## 📞 技術支援

如果遇到問題，請檢查：
1. 檔案格式是否支援
2. 編碼設定是否正確
3. 欄位選擇是否合理
4. 依賴套件是否已安裝

## 🔄 版本更新

### v2.0 (通用版)
- 新增通用報表處理器
- 智慧偵測功能
- 支援更多檔案格式
- 可自定義設定

### v1.0 (原始版)
- 針對特定公司優化
- 固定的處理設定
- 基本的 Excel 處理功能

## 📝 授權條款

本工具僅供學習和研究使用，請勿用於商業用途。
